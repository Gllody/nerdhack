/*
 * This file is part of the Meteor Client distribution (https://github.com/MeteorDevelopment/meteor-client).
 * Copyright (c) Meteor Development.
 */

package meteordevelopment.meteorclient.systems.modules.exploits;

import meteordevelopment.meteorclient.settings.*;
import meteordevelopment.meteorclient.systems.modules.Categories;
import meteordevelopment.meteorclient.systems.modules.Module;
import meteordevelopment.meteorclient.events.world.TickEvent;
import meteordevelopment.meteorclient.utils.player.ChatUtils;
import meteordevelopment.meteorclient.utils.render.color.SettingColor;
import meteordevelopment.orbit.EventHandler;
import meteordevelopment.orbit.EventPriority;
import java.util.Random;

import net.minecraft.text.Style;
import net.minecraft.text.Text;
import net.minecraft.text.TextColor;

/**
 * @author KassuK
 */

public class SexPositioner extends Module {
    public SexPositioner() {
        super(Categories.Misc, "SexPositioner", "Sex position");
    }

    private final SettingGroup sgGeneral = settings.getDefaultGroup();

    private final Setting<Boolean> single = sgGeneral.add(new BoolSetting.Builder()
        .name("Single")
        .description("Only sends the message once.")
        .defaultValue(false)
        .build()
    );

    private final Setting<Integer> delay = sgGeneral.add(new IntSetting.Builder()
        .name("Delay")
        .description("Tick delay between sending the message.")
        .defaultValue(5)
        .range(0, 60)
        .sliderMax(60)
        .visible(() -> !single.get())
        .build()
    );
    public final Setting<SettingColor> feedbackColor = sgGeneral.add(new ColorSetting.Builder()
        .name("feedback-color")
        .description("Color of the feedback text.")
        .defaultValue(new SettingColor(146,188,98))
        .build()
    );

    private int timer = 0;
    private boolean last = false;





    @EventHandler(priority = EventPriority.HIGH)
    private void onTick(TickEvent.Pre event) {
        if (mc.player != null && mc.world != null) {
            if (mc.player.isAlive()) {
                if (single.get()) {
                    if (!last) {
                        last = true;
                        info("New nerd");
                    }
                } else {
                    if (timer > 0) {
                        timer--;
                    } else {
                        timer = delay.get();
                        last = true;
                        Random rand = new Random();
                        int nerd1 = rand.nextInt(9);
                        ChatUtils.sendMsg(Text.literal("Sex position: ").append(Text.literal("["+nerd1+"]")
                            .setStyle(Style.EMPTY.withColor(TextColor.fromRgb(feedbackColor.get().getPacked()))
                            )
                        ));
                    }
                }
            } else if (last) {
                last = false;
                info("Unable to SendPackets after death.");
            }
        }
    }
}

